DROP TABLE IF EXISTS payments;
DROP TABLE IF EXISTS loans;
DROP TABLE IF EXISTS signers;
DROP TABLE IF EXISTS auth_tokens;

CREATE TABLE signers (
 id SERIAL PRIMARY KEY,
 first_name VARCHAR(100) NOT NULL,
 last_name VARCHAR(100) NOT NULL,
 email VARCHAR(255) UNIQUE NOT NULL
);

CREATE TABLE loans (
 id SERIAL PRIMARY KEY,
 principal_amount NUMERIC(19, 2) NOT NULL,
 fee_amount NUMERIC(19, 2) NOT NULL,
 outstanding_balance NUMERIC(19, 2) NOT NULL,
 signer_ids INTEGER[] NOT NULL,
 created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 is_active BOOLEAN DEFAULT TRUE
);

CREATE TABLE payments (
 id SERIAL PRIMARY KEY,
 amount NUMERIC(19, 2) NOT NULL,
 loan_id INTEGER REFERENCES loans(id),
 status VARCHAR(20),
 external_payment_id VARCHAR(255),
 created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE auth_tokens (
 id SERIAL PRIMARY KEY,
 token VARCHAR(100) NOT NULL,
 created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);